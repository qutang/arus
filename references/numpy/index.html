<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="ARUS package provides a computational framework to manage and process ubiquitous sensory data for human activity recognition."><link href=https://qutang.github.io/arus/references/numpy/ rel=canonical><meta name=author content="Qu Tang"><meta name=lang:clipboard.copy content="Copy to clipboard"><meta name=lang:clipboard.copied content="Copied to clipboard"><meta name=lang:search.language content=en><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content="No matching documents"><meta name=lang:search.result.one content="1 matching document"><meta name=lang:search.result.other content="# matching documents"><meta name=lang:search.tokenizer content=[\s\-]+><link rel="shortcut icon" href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.6.3"><title>Numpy - ARUS Python package</title><link rel=stylesheet href=../../assets/stylesheets/application.adb8469c.css><link rel=stylesheet href=../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../assets/javascripts/modernizr.86422ebf.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../assets/fonts/material-icons.css><link rel=stylesheet href=../../assets/css/extra.css></head> <body dir=ltr data-md-color-primary=white data-md-color-accent=orange> <svg class=md-svg> <defs> <svg xmlns=http://www.w3.org/2000/svg width=416 height=448 viewbox="0 0 416 448" id=__github><path fill=currentColor d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#arus.extensions.numpy.butterworth tabindex=0 class=md-skip> Skip to content </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://qutang.github.io/arus/ title="ARUS Python package" aria-label="ARUS Python package" class="md-header-nav__button md-logo"> <i class=md-icon>directions_run</i> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> ARUS Python package </span> <span class=md-header-nav__topic> Numpy </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input aria-label=search name=query placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source> <a href=https://github.com/qutang/arus/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> qutang/arus </div> </a> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../stream/ class=md-tabs__link> API reference </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://qutang.github.io/arus/ title="ARUS Python package" class="md-nav__button md-logo"> <i class=md-icon>directions_run</i> </a> ARUS Python package </label> <div class=md-nav__source> <a href=https://github.com/qutang/arus/ title="Go to repository" class=md-source data-md-source=github> <div class=md-source__icon> <svg viewbox="0 0 24 24" width=24 height=24> <use xlink:href=#__github width=24 height=24></use> </svg> </div> <div class=md-source__repository> qutang/arus </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-1 type=checkbox id=nav-1> <label class=md-nav__link for=nav-1> Home </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-1> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Overview class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../LICENSE/ title=License class=md-nav__link> License </a> </li> <li class=md-nav__item> <a href=../../CODE_OF_CONDUCT/ title="Code of conduct" class=md-nav__link> Code of conduct </a> </li> <li class=md-nav__item> <a href=../../changelogs/ title=Changelogs class=md-nav__link> Changelogs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> API reference </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> API reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-1 type=checkbox id=nav-2-1> <label class=md-nav__link for=nav-2-1> Data Flow </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-1> Data Flow </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../stream/ title=Stream class=md-nav__link> Stream </a> </li> <li class=md-nav__item> <a href=../generator/ title=Generator class=md-nav__link> Generator </a> </li> <li class=md-nav__item> <a href=../segmentor/ title=Segmentor class=md-nav__link> Segmentor </a> </li> <li class=md-nav__item> <a href=../scheduler/ title=Scheduler class=md-nav__link> Scheduler </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-2 type=checkbox id=nav-2-2> <label class=md-nav__link for=nav-2-2> Data processing </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-2> Data processing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../accelerometer/ title=Accelerometer class=md-nav__link> Accelerometer </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-3 type=checkbox id=nav-2-3> <label class=md-nav__link for=nav-2-3> Plugins </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-3> Plugins </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../metawear/ title=Metawear class=md-nav__link> Metawear </a> </li> <li class=md-nav__item> <a href=../actigraph/ title=Actigraph class=md-nav__link> Actigraph </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4 checked> <label class=md-nav__link for=nav-2-4> Extensions </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-4> Extensions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../filesys/ title=Filesys class=md-nav__link> Filesys </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <a href=./ title=Numpy class="md-nav__link md-nav__link--active"> Numpy </a> </li> <li class=md-nav__item> <a href=../pandas/ title=Pandas class=md-nav__link> Pandas </a> </li> <li class=md-nav__item> <a href=../plotting/ title=Plotting class=md-nav__link> Plotting </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../mhealth_format/ title="Mhealth format" class=md-nav__link> Mhealth format </a> </li> <li class=md-nav__item> <a href=../dataset/ title=Dataset class=md-nav__link> Dataset </a> </li> <li class=md-nav__item> <a href=../developer/ title=Developer class=md-nav__link> Developer </a> </li> <li class=md-nav__item> <a href=../moment/ title=Moment class=md-nav__link> Moment </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <a href=https://github.com/qutang/arus/blob/master/docs/references/numpy.md title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a> <p><code>arus.ext.numpy</code></p> <p>Module of extension functions to be applied to numpy objects (e.g., Arrays)</p> <p>Author: Qu Tang</p> <p>Date: 2020-02-03</p> <p>License: see LICENSE file</p> <h2 id=arus.extensions.numpy.butterworth><code class=highlight><span class=n>butterworth</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>sr</span><span class=p>,</span> <span class=n>cut_offs</span><span class=p>,</span> <span class=n>order</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>filter_type</span><span class=o>=</span><span class=s1>&#39;low&#39;</span><span class=p>)</span></code><a class=headerlink href=#arus.extensions.numpy.butterworth title="Permanent link">&para;</a></h2> <details class=note><summary>Show source code in <code>extensions\numpy.py</code></summary><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span>73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91</pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>butterworth</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>sr</span><span class=p>,</span> <span class=n>cut_offs</span><span class=p>,</span> <span class=n>order</span><span class=o>=-</span><span class=mi>1</span><span class=p>,</span> <span class=n>filter_type</span><span class=o>=</span><span class=s1>&#39;low&#39;</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Apply butterworth IIR filter to a 2D array</span>

<span class=sd>    Args:</span>
<span class=sd>        X (numpy.ndarray): A 1D or 2D numpy array</span>
<span class=sd>        sr (float): sampling rate in Hz</span>
<span class=sd>        cut_offs (float or list): cut off frequencies in Hz</span>
<span class=sd>        order (float): order of the filter</span>

<span class=sd>    Keyword Arguments:</span>
<span class=sd>        filter_type (str): type of the filter. Could be &#39;low&#39;, &#39;high&#39;, &#39;pass&#39; or &#39;stop&#39;</span>

<span class=sd>    Returns:</span>
<span class=sd>        filtered_X (numpy.ndarray): A numpy array with the same shape as X</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>Wn</span> <span class=o>=</span> <span class=n>_get_wn</span><span class=p>(</span><span class=n>cut_offs</span><span class=p>,</span> <span class=n>sr</span><span class=p>)</span>
    <span class=n>B</span><span class=p>,</span> <span class=n>A</span> <span class=o>=</span> <span class=n>sp_signal</span><span class=o>.</span><span class=n>butter</span><span class=p>(</span><span class=n>order</span><span class=p>,</span> <span class=n>Wn</span><span class=p>,</span> <span class=n>btype</span><span class=o>=</span><span class=n>filter_type</span><span class=p>,</span> <span class=n>output</span><span class=o>=</span><span class=s1>&#39;ba&#39;</span><span class=p>)</span>
    <span class=n>result</span> <span class=o>=</span> <span class=n>sp_signal</span><span class=o>.</span><span class=n>filtfilt</span><span class=p>(</span><span class=n>B</span><span class=p>,</span> <span class=n>A</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;pad&#39;</span><span class=p>,</span> <span class=n>padtype</span><span class=o>=</span><span class=s1>&#39;even&#39;</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>result</span>
</code></pre></div> </td></tr></table> </details> <p>Apply butterworth IIR filter to a 2D array</p> <p><strong>Parameters</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>X</code></td> <td></td> <td>A 1D or 2D numpy array</td> <td><em>required</em></td> </tr> <tr> <td><code>sr</code></td> <td></td> <td>sampling rate in Hz</td> <td><em>required</em></td> </tr> <tr> <td><code>cut_offs</code></td> <td></td> <td>cut off frequencies in Hz</td> <td><em>required</em></td> </tr> <tr> <td><code>order</code></td> <td></td> <td>order of the filter</td> <td><code>-1</code></td> </tr> </tbody> </table> <p>Keyword Arguments: filter_type (str): type of the filter. Could be &lsquo;low&rsquo;, &lsquo;high&rsquo;, &lsquo;pass&rsquo; or &lsquo;stop&rsquo;</p> <p><strong>Returns</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>``</td> <td>filtered_X (numpy.ndarray): A numpy array with the same shape as X</td> </tr> </tbody> </table> <h2 id=arus.extensions.numpy.detect_peaks><code class=highlight><span class=n>detect_peaks</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>mph</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>mpd</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>edge</span><span class=o>=</span><span class=s1>&#39;rising&#39;</span><span class=p>,</span> <span class=n>kpsh</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>valley</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>show</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code><a class=headerlink href=#arus.extensions.numpy.detect_peaks title="Permanent link">&para;</a></h2> <details class=note><summary>Show source code in <code>extensions\numpy.py</code></summary><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span>139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273</pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>detect_peaks</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>mph</span><span class=o>=</span><span class=kc>None</span><span class=p>,</span> <span class=n>mpd</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>threshold</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>edge</span><span class=o>=</span><span class=s1>&#39;rising&#39;</span><span class=p>,</span>
                 <span class=n>kpsh</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>valley</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>show</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Detect peaks in data based on their amplitude and other features.</span>

<span class=sd>    Parameters</span>
<span class=sd>    ----------</span>
<span class=sd>    x : 1D array_like</span>
<span class=sd>        data.</span>
<span class=sd>    mph : {None, number}, optional (default = None)</span>
<span class=sd>        detect peaks that are greater than minimum peak height.</span>
<span class=sd>    mpd : positive integer, optional (default = 1)</span>
<span class=sd>        detect peaks that are at least separated by minimum peak distance (in</span>
<span class=sd>        number of data).</span>
<span class=sd>    threshold : positive number, optional (default = 0)</span>
<span class=sd>        detect peaks (valleys) that are greater (smaller) than `threshold`</span>
<span class=sd>        in relation to their immediate neighbors.</span>
<span class=sd>    edge : {None, &#39;rising&#39;, &#39;falling&#39;, &#39;both&#39;}, optional (default = &#39;rising&#39;)</span>
<span class=sd>        for a flat peak, keep only the rising edge (&#39;rising&#39;), only the</span>
<span class=sd>        falling edge (&#39;falling&#39;), both edges (&#39;both&#39;), or don&#39;t detect a</span>
<span class=sd>        flat peak (None).</span>
<span class=sd>    kpsh : bool, optional (default = False)</span>
<span class=sd>        keep peaks with same height even if they are closer than `mpd`.</span>
<span class=sd>    valley : bool, optional (default = False)</span>
<span class=sd>        if True (1), detect valleys (local minima) instead of peaks.</span>
<span class=sd>    show : bool, optional (default = False)</span>
<span class=sd>        if True (1), plot data in matplotlib figure.</span>
<span class=sd>    ax : a matplotlib.axes.Axes instance, optional (default = None).</span>

<span class=sd>    Returns</span>
<span class=sd>    -------</span>
<span class=sd>    ind : 1D array_like</span>
<span class=sd>        indeces of the peaks in `x`.</span>

<span class=sd>    Notes</span>
<span class=sd>    -----</span>
<span class=sd>    The detection of valleys instead of peaks is performed internally by simply</span>
<span class=sd>    negating the data: `ind_valleys = detect_peaks(-x)`</span>

<span class=sd>    The function can handle NaN&#39;s </span>

<span class=sd>    See this IPython Notebook [1]_.</span>

<span class=sd>    References</span>
<span class=sd>    ----------</span>
<span class=sd>    .. [1] http://nbviewer.ipython.org/github/demotu/BMC/blob/master/notebooks/DetectPeaks.ipynb</span>

<span class=sd>    Examples</span>
<span class=sd>    --------</span>
<span class=sd>    &gt;&gt;&gt; from detect_peaks import detect_peaks</span>
<span class=sd>    &gt;&gt;&gt; x = np.random.randn(100)</span>
<span class=sd>    &gt;&gt;&gt; x[60:81] = np.nan</span>
<span class=sd>    &gt;&gt;&gt; # detect all peaks and plot data</span>
<span class=sd>    &gt;&gt;&gt; ind = detect_peaks(x, show=True)</span>
<span class=sd>    &gt;&gt;&gt; print(ind)</span>

<span class=sd>    &gt;&gt;&gt; x = np.sin(2*np.pi*5*np.linspace(0, 1, 200)) + np.random.randn(200)/5</span>
<span class=sd>    &gt;&gt;&gt; # set minimum peak height = 0 and minimum peak distance = 20</span>
<span class=sd>    &gt;&gt;&gt; detect_peaks(x, mph=0, mpd=20, show=True)</span>

<span class=sd>    &gt;&gt;&gt; x = [0, 1, 0, 2, 0, 3, 0, 2, 0, 1, 0]</span>
<span class=sd>    &gt;&gt;&gt; # set minimum peak distance = 2</span>
<span class=sd>    &gt;&gt;&gt; detect_peaks(x, mpd=2, show=True)</span>

<span class=sd>    &gt;&gt;&gt; x = np.sin(2*np.pi*5*np.linspace(0, 1, 200)) + np.random.randn(200)/5</span>
<span class=sd>    &gt;&gt;&gt; # detection of valleys instead of peaks</span>
<span class=sd>    &gt;&gt;&gt; detect_peaks(x, mph=0, mpd=20, valley=True, show=True)</span>

<span class=sd>    &gt;&gt;&gt; x = [0, 1, 1, 0, 1, 1, 0]</span>
<span class=sd>    &gt;&gt;&gt; # detect both edges</span>
<span class=sd>    &gt;&gt;&gt; detect_peaks(x, edge=&#39;both&#39;, show=True)</span>

<span class=sd>    &gt;&gt;&gt; x = [-2, 1, -2, 2, 1, 1, 3, 0]</span>
<span class=sd>    &gt;&gt;&gt; # set threshold = 2</span>
<span class=sd>    &gt;&gt;&gt; detect_peaks(x, threshold = 2, show=True)</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>x</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>atleast_1d</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float64&#39;</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>x</span><span class=o>.</span><span class=n>size</span> <span class=o>&lt;</span> <span class=mi>3</span><span class=p>:</span>
        <span class=k>return</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=k>if</span> <span class=n>valley</span><span class=p>:</span>
        <span class=n>x</span> <span class=o>=</span> <span class=o>-</span><span class=n>x</span>
    <span class=c1># find indexes of all peaks</span>
    <span class=n>dx</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span> <span class=o>-</span> <span class=n>x</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=c1># handle NaN&#39;s</span>
    <span class=n>indnan</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>x</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
    <span class=k>if</span> <span class=n>indnan</span><span class=o>.</span><span class=n>size</span><span class=p>:</span>
        <span class=n>x</span><span class=p>[</span><span class=n>indnan</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span>
        <span class=n>dx</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>isnan</span><span class=p>(</span><span class=n>dx</span><span class=p>))[</span><span class=mi>0</span><span class=p>]]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>inf</span>
    <span class=n>ine</span><span class=p>,</span> <span class=n>ire</span><span class=p>,</span> <span class=n>ife</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>([[],</span> <span class=p>[],</span> <span class=p>[]],</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
    <span class=k>if</span> <span class=ow>not</span> <span class=n>edge</span><span class=p>:</span>
        <span class=n>ine</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>((</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>dx</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=n>dx</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
    <span class=k>else</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>edge</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;rising&#39;</span><span class=p>,</span> <span class=s1>&#39;both&#39;</span><span class=p>]:</span>
            <span class=n>ire</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>((</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>dx</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span>
                           <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=n>dx</span><span class=p>))</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
        <span class=k>if</span> <span class=n>edge</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=p>[</span><span class=s1>&#39;falling&#39;</span><span class=p>,</span> <span class=s1>&#39;both&#39;</span><span class=p>]:</span>
            <span class=n>ife</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>((</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>dx</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=o>&amp;</span>
                           <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=mi>0</span><span class=p>,</span> <span class=n>dx</span><span class=p>))</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>))[</span><span class=mi>0</span><span class=p>]</span>
    <span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>ine</span><span class=p>,</span> <span class=n>ire</span><span class=p>,</span> <span class=n>ife</span><span class=p>)))</span>
    <span class=c1># handle NaN&#39;s</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>indnan</span><span class=o>.</span><span class=n>size</span><span class=p>:</span>
        <span class=c1># NaN&#39;s and values close to NaN&#39;s cannot be peaks</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>ind</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>in1d</span><span class=p>(</span><span class=n>ind</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>unique</span><span class=p>(</span>
            <span class=n>np</span><span class=o>.</span><span class=n>hstack</span><span class=p>((</span><span class=n>indnan</span><span class=p>,</span> <span class=n>indnan</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>indnan</span><span class=o>+</span><span class=mi>1</span><span class=p>))),</span> <span class=n>invert</span><span class=o>=</span><span class=kc>True</span><span class=p>)]</span>
    <span class=c1># first and last values of x cannot be peaks</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>ind</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>ind</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>ind</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=n>x</span><span class=o>.</span><span class=n>size</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>ind</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
    <span class=c1># remove peaks &lt; minimum peak height</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>mph</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span><span class=p>:</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>ind</span><span class=p>[</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span> <span class=o>&gt;=</span> <span class=n>mph</span><span class=p>]</span>
    <span class=c1># remove peaks - neighbors &lt; threshold</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>threshold</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
        <span class=n>dx</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>vstack</span><span class=p>([</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span><span class=o>-</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span><span class=o>-</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=o>+</span><span class=mi>1</span><span class=p>]]),</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>delete</span><span class=p>(</span><span class=n>ind</span><span class=p>,</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>dx</span> <span class=o>&lt;</span> <span class=n>threshold</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
    <span class=c1># detect small peaks closer than minimum peak distance</span>
    <span class=k>if</span> <span class=n>ind</span><span class=o>.</span><span class=n>size</span> <span class=ow>and</span> <span class=n>mpd</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>ind</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>argsort</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>])][::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>  <span class=c1># sort ind by peak height</span>
        <span class=n>idel</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>ind</span><span class=o>.</span><span class=n>size</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>bool</span><span class=p>)</span>
        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>ind</span><span class=o>.</span><span class=n>size</span><span class=p>):</span>
            <span class=k>if</span> <span class=ow>not</span> <span class=n>idel</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
                <span class=c1># keep peaks with the same height if kpsh is True</span>
                <span class=n>idel</span> <span class=o>=</span> <span class=n>idel</span> <span class=o>|</span> <span class=p>(</span><span class=n>ind</span> <span class=o>&gt;=</span> <span class=n>ind</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-</span> <span class=n>mpd</span><span class=p>)</span> <span class=o>&amp;</span> <span class=p>(</span><span class=n>ind</span> <span class=o>&lt;=</span> <span class=n>ind</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+</span> <span class=n>mpd</span><span class=p>)</span> \
                    <span class=o>&amp;</span> <span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span> <span class=o>&gt;</span> <span class=n>x</span><span class=p>[</span><span class=n>ind</span><span class=p>]</span> <span class=k>if</span> <span class=n>kpsh</span> <span class=k>else</span> <span class=kc>True</span><span class=p>)</span>
                <span class=n>idel</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>  <span class=c1># Keep current peak</span>
        <span class=c1># remove the small peaks and sort back the indexes by their occurrence</span>
        <span class=n>ind</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>ind</span><span class=p>[</span><span class=o>~</span><span class=n>idel</span><span class=p>])</span>

    <span class=k>if</span> <span class=n>show</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>indnan</span><span class=o>.</span><span class=n>size</span><span class=p>:</span>
            <span class=n>x</span><span class=p>[</span><span class=n>indnan</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>nan</span>
        <span class=k>if</span> <span class=n>valley</span><span class=p>:</span>
            <span class=n>x</span> <span class=o>=</span> <span class=o>-</span><span class=n>x</span>
        <span class=n>_plot_peaks</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>mph</span><span class=p>,</span> <span class=n>mpd</span><span class=p>,</span> <span class=n>threshold</span><span class=p>,</span> <span class=n>edge</span><span class=p>,</span> <span class=n>valley</span><span class=p>,</span> <span class=n>ax</span><span class=p>,</span> <span class=n>ind</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>ind</span>
</code></pre></div> </td></tr></table> </details> <p>Detect peaks in data based on their amplitude and other features.</p> <h2 id=parameters>Parameters<a class=headerlink href=#parameters title="Permanent link">&para;</a></h2> <p>x : 1D array_like data. mph : {None, number}, optional (default = None) detect peaks that are greater than minimum peak height. mpd : positive integer, optional (default = 1) detect peaks that are at least separated by minimum peak distance (in number of data). threshold : positive number, optional (default = 0) detect peaks (valleys) that are greater (smaller) than <code>threshold</code> in relation to their immediate neighbors. edge : {None, &lsquo;rising&rsquo;, &lsquo;falling&rsquo;, &lsquo;both&rsquo;}, optional (default = &lsquo;rising&rsquo;) for a flat peak, keep only the rising edge (&lsquo;rising&rsquo;), only the falling edge (&lsquo;falling&rsquo;), both edges (&lsquo;both&rsquo;), or don&rsquo;t detect a flat peak (None). kpsh : bool, optional (default = False) keep peaks with same height even if they are closer than <code>mpd</code>. valley : bool, optional (default = False) if True (1), detect valleys (local minima) instead of peaks. show : bool, optional (default = False) if True (1), plot data in matplotlib figure. ax : a matplotlib.axes.Axes instance, optional (default = None).</p> <h2 id=returns>Returns<a class=headerlink href=#returns title="Permanent link">&para;</a></h2> <p>ind : 1D array_like indeces of the peaks in <code>x</code>.</p> <h2 id=notes>Notes<a class=headerlink href=#notes title="Permanent link">&para;</a></h2> <p>The detection of valleys instead of peaks is performed internally by simply negating the data: <code>ind_valleys = detect_peaks(-x)</code></p> <p>The function can handle NaN&rsquo;s </p> <p>See this IPython Notebook [1]_.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">&para;</a></h2> <p>.. [1] http://nbviewer.ipython.org/github/demotu/BMC/blob/master/notebooks/DetectPeaks.ipynb</p> <h2 id=examples>Examples<a class=headerlink href=#examples title="Permanent link">&para;</a></h2> <blockquote> <blockquote> <blockquote> <p>from detect_peaks import detect_peaks x = np.random.randn(100) x[60:81] = np.nan</p> <h1 id=detect-all-peaks-and-plot-data>detect all peaks and plot data<a class=headerlink href=#detect-all-peaks-and-plot-data title="Permanent link">&para;</a></h1> <p>ind = detect_peaks(x, show=True) print(ind)</p> <p>x = np.sin(2<em>np.pi</em>5*np.linspace(0, 1, 200)) + np.random.randn(200)/5</p> <h1 id=set-minimum-peak-height-0-and-minimum-peak-distance-20>set minimum peak height = 0 and minimum peak distance = 20<a class=headerlink href=#set-minimum-peak-height-0-and-minimum-peak-distance-20 title="Permanent link">&para;</a></h1> <p>detect_peaks(x, mph=0, mpd=20, show=True)</p> <p>x = [0, 1, 0, 2, 0, 3, 0, 2, 0, 1, 0]</p> <h1 id=set-minimum-peak-distance-2>set minimum peak distance = 2<a class=headerlink href=#set-minimum-peak-distance-2 title="Permanent link">&para;</a></h1> <p>detect_peaks(x, mpd=2, show=True)</p> <p>x = np.sin(2<em>np.pi</em>5*np.linspace(0, 1, 200)) + np.random.randn(200)/5</p> <h1 id=detection-of-valleys-instead-of-peaks>detection of valleys instead of peaks<a class=headerlink href=#detection-of-valleys-instead-of-peaks title="Permanent link">&para;</a></h1> <p>detect_peaks(x, mph=0, mpd=20, valley=True, show=True)</p> <p>x = [0, 1, 1, 0, 1, 1, 0]</p> <h1 id=detect-both-edges>detect both edges<a class=headerlink href=#detect-both-edges title="Permanent link">&para;</a></h1> <p>detect_peaks(x, edge=&rsquo;both&rsquo;, show=True)</p> <p>x = [-2, 1, -2, 2, 1, 1, 3, 0]</p> <h1 id=set-threshold-2>set threshold = 2<a class=headerlink href=#set-threshold-2 title="Permanent link">&para;</a></h1> <p>detect_peaks(x, threshold = 2, show=True)</p> </blockquote> </blockquote> </blockquote> <h2 id=arus.extensions.numpy.resample><code class=highlight><span class=n>resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>sr</span><span class=p>,</span> <span class=n>new_sr</span><span class=p>)</span></code><a class=headerlink href=#arus.extensions.numpy.resample title="Permanent link">&para;</a></h2> <details class=note><summary>Show source code in <code>extensions\numpy.py</code></summary><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span> 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110</pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>resample</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>sr</span><span class=p>,</span> <span class=n>new_sr</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Apply resampling IIR filter to a 2D array</span>

<span class=sd>    Args:</span>
<span class=sd>        X (numpy.ndarray): A 1D or 2D numpy array</span>
<span class=sd>        sr (float): sampling rate in Hz</span>
<span class=sd>        new_sr (float): resampled sampling rate in Hz</span>

<span class=sd>    Returns:</span>
<span class=sd>        resampled_X (numpy.ndarray): A numpy array with the new sampling rate</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=n>lcm</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>lcm</span><span class=p>(</span><span class=n>sr</span><span class=p>,</span> <span class=n>new_sr</span><span class=p>)</span>
    <span class=n>up</span> <span class=o>=</span> <span class=n>lcm</span> <span class=o>/</span> <span class=n>sr</span>
    <span class=n>down</span> <span class=o>=</span> <span class=n>lcm</span> <span class=o>/</span> <span class=n>new_sr</span>
    <span class=c1># TODO: use prime factorization to generate a cascade of downsampling filter</span>
    <span class=n>new_X</span> <span class=o>=</span> <span class=n>sp_signal</span><span class=o>.</span><span class=n>resample_poly</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>up</span><span class=o>=</span><span class=n>up</span><span class=p>,</span> <span class=n>down</span><span class=o>=</span><span class=n>down</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>new_X</span>
</code></pre></div> </td></tr></table> </details> <p>Apply resampling IIR filter to a 2D array</p> <p><strong>Parameters</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>X</code></td> <td></td> <td>A 1D or 2D numpy array</td> <td><em>required</em></td> </tr> <tr> <td><code>sr</code></td> <td></td> <td>sampling rate in Hz</td> <td><em>required</em></td> </tr> <tr> <td><code>new_sr</code></td> <td></td> <td>resampled sampling rate in Hz</td> <td><em>required</em></td> </tr> </tbody> </table> <p><strong>Returns</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>``</td> <td>resampled_X (numpy.ndarray): A numpy array with the new sampling rate</td> </tr> </tbody> </table> <h2 id=arus.extensions.numpy.resample_timestamps><code class=highlight><span class=n>resample_timestamps</span><span class=p>(</span><span class=n>ts</span><span class=p>,</span> <span class=n>new_n</span><span class=p>)</span></code><a class=headerlink href=#arus.extensions.numpy.resample_timestamps title="Permanent link">&para;</a></h2> <details class=note><summary>Show source code in <code>extensions\numpy.py</code></summary><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span>113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>resample_timestamps</span><span class=p>(</span><span class=n>ts</span><span class=p>,</span> <span class=n>new_n</span><span class=p>):</span>
    <span class=sd>&quot;&quot;&quot;Resample timestamps to new sampling rate</span>

<span class=sd>    This function should be used together with `arus.extensions.numpy.resample`.</span>

<span class=sd>    Args:</span>
<span class=sd>        ts (numpy.ndarray): A 1D numpy array storing timestamps in `np.datetime64` format</span>
<span class=sd>        new_n (int): number of samples in the resampled sequence</span>

<span class=sd>    Returns:</span>
<span class=sd>        resampled_ts (numpy.ndarray): A 1D numpy array with the resampled timestamps</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>assert</span> <span class=nb>type</span><span class=p>(</span><span class=n>ts</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>==</span> <span class=n>np</span><span class=o>.</span><span class=n>datetime64</span>
    <span class=n>st</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;datetime64[ms]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float64&#39;</span><span class=p>)</span>
    <span class=n>et</span> <span class=o>=</span> <span class=n>ts</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;datetime64[ms]&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=s1>&#39;float64&#39;</span><span class=p>)</span>
    <span class=n>new_ts</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>linspace</span><span class=p>(</span><span class=n>st</span><span class=p>,</span> <span class=n>et</span><span class=p>,</span> <span class=n>num</span><span class=o>=</span><span class=n>new_n</span><span class=p>)</span>
    <span class=n>vf</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>vectorize</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>datetime64</span><span class=p>(</span><span class=nb>int</span><span class=p>(</span><span class=n>x</span><span class=p>),</span> <span class=s1>&#39;ms&#39;</span><span class=p>))</span>
    <span class=n>new_ts</span> <span class=o>=</span> <span class=n>vf</span><span class=p>(</span><span class=n>new_ts</span><span class=p>)</span>
    <span class=k>return</span> <span class=n>new_ts</span>
</code></pre></div> </td></tr></table> </details> <p>Resample timestamps to new sampling rate</p> <p>This function should be used together with <code>arus.extensions.numpy.resample</code>.</p> <p><strong>Parameters</strong></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code>ts</code></td> <td></td> <td>A 1D numpy array storing timestamps in <code>np.datetime64</code> format</td> <td><em>required</em></td> </tr> <tr> <td><code>new_n</code></td> <td></td> <td>number of samples in the resampled sequence</td> <td><em>required</em></td> </tr> </tbody> </table> <p><strong>Returns</strong></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>``</td> <td>resampled_ts (numpy.ndarray): A 1D numpy array with the resampled timestamps</td> </tr> </tbody> </table> <hr> <div class=md-source-date> <small> Last update: March 4, 2020 </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../filesys/ title=Filesys class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Previous </span> Filesys </span> </div> </a> <a href=../pandas/ title=Pandas class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> Next </span> Pandas </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> 2020 © Qu Tang </div> powered by <a href=https://www.mkdocs.org target=_blank rel=noopener>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../assets/fonts/font-awesome.css> <a href=https://qutang.dev target=_blank rel=noopener title=globe class="md-footer-social__link fa fa-globe"></a> <a href=https://github.com/qutang target=_blank rel=noopener title=github class="md-footer-social__link fa fa-github"></a> <a href=https://www.linkedin.com/in/qutang target=_blank rel=noopener title=linkedin class="md-footer-social__link fa fa-linkedin"></a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/application.c33a9706.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script> </body> </html>